
# ğŸŸï¸ Sistema de Bilhetagem - ItaÃº Case

Este projeto consiste em um sistema de bilhetagem distribuÃ­do, baseado em **microserviÃ§os** e **arquitetura hexagonal**, com foco em princÃ­pios de seguranÃ§a (OWASP), boas prÃ¡ticas de design (Clean Architecture, SOLID, 12 Factors), e integraÃ§Ã£o entre serviÃ§os.

Foi desenvolvido como entrega para o **case tÃ©cnico ItaÃº**.

## ğŸŒŸ Arquitetura e DecisÃµes

A arquitetura escolhida foi **microserviÃ§os com arquitetura hexagonal** para cada serviÃ§o, com os seguintes motivos:

âœ… SeparaÃ§Ã£o clara de domÃ­nios de negÃ³cio (DDD)
âœ… EvoluÃ§Ã£o e manutenÃ§Ã£o desacoplada
âœ… Testes unitÃ¡rios e de integraÃ§Ã£o mais fÃ¡ceis
âœ… Melhor suporte a escalabilidade
âœ… Cada serviÃ§o com banco prÃ³prio (PostgreSQL no compose, SQLite local)

Todos os serviÃ§os seguem:

- **Clean Architecture** â€” domÃ­nio isolado da infraestrutura
- **PrincÃ­pios SOLID** e 12 Factors
- PrÃ¡ticas de seguranÃ§a OWASP (validaÃ§Ã£o, controle de erros)
- IntegraÃ§Ã£o por REST entre serviÃ§os
- API OpenAPI (Swagger gerado automaticamente)

**OrquestraÃ§Ã£o:** GitHub Actions (CI/CD) â€” nÃ£o incluso na entrega, mas documentado.

**Banco:** PostgreSQL ou SQLite (para testes locais)

**Backend:** Python 3.12 + FastAPI + SQLAlchemy

**PDF:** FPDF (geraÃ§Ã£o de ingressos)

**Outros:** Makefile e scripts utilitÃ¡rios para facilitar o uso.

---

## ğŸ§± ServiÃ§os

- **user-service**: CRUD de usuÃ¡rios
- **event-service**: CRUD de eventos
- **product-service**: Produtos complementares
- **ticket-service**: Controle de ingressos + geraÃ§Ã£o de PDF
- **reservation-service**: Reservas de ingressos, com expiraÃ§Ã£o automÃ¡tica
- **order-service**: Orquestra a finalizaÃ§Ã£o de pedidos e confirmaÃ§Ã£o de reservas

---

## ğŸ—ºï¸ Fluxo de Compra

1ï¸âƒ£ UsuÃ¡rio e evento sÃ£o criados  
2ï¸âƒ£ Tickets sÃ£o cadastrados para o evento  
3ï¸âƒ£ Reservas sÃ£o feitas (temporÃ¡rias)  
4ï¸âƒ£ Pedido Ã© finalizado (confirma reservas + gera ticket PDF)

---

## âš™ï¸ Como rodar o projeto

### Localmente (SQLite, sem docker)

```bash
# Instalar dependÃªncias
make prepare

# Rodar todos os serviÃ§os (6 serviÃ§os)
make run
```

### Com PostgreSQL (docker-compose)

```bash
make up_db
make up_services
```

---

## ğŸš€ Endpoints (exemplos)

### `user-service`

```http
GET /users/
GET /users/{id}
POST /users/ { name, email }
```

### `event-service`

```http
GET /events/
POST /events/ { title, location, date }
```

### `ticket-service`

```http
POST /tickets/ { event_id, quantity, price }
POST /tickets/from-order { payload do pedido }
GET /tickets/{id}/pdf
```

### `reservation-service`

```http
POST /reservations/ { user_id, ticket_id, quantity }
GET /reservations/user/{user_id}
```

### `order-service`

```http
POST /orders/ { user_id, event_id, items, products, total_price }
GET /orders/
GET /orders/{id}
```

---

## ğŸ›¡ï¸ SeguranÃ§a

âœ… ValidaÃ§Ã£o de payloads com Pydantic  
âœ… SQL Injection safe (SQLAlchemy ORM)  
âœ… Sem exposiÃ§Ã£o de dados sensÃ­veis  
âœ… Logs protegidos  
âœ… IntegraÃ§Ã£o entre serviÃ§os autenticada por IP local (exemplo)

---

## ğŸ› ï¸ Tecnologias

- Python 3.12
- FastAPI
- SQLAlchemy
- SQLite / PostgreSQL
- FPDF (geraÃ§Ã£o de PDF de ingressos)
- qrcode
- Makefile + Bash Scripts

---

## ğŸ Como rodar os testes

```bash
make test
```

---

## ğŸ¯ ConclusÃ£o

Essa arquitetura foi escolhida para permitir alta coesÃ£o de domÃ­nios e separaÃ§Ã£o de responsabilidades, e garantir que a manutenÃ§Ã£o e evoluÃ§Ã£o sejam facilitadas.  
A entrega permite rodar 100% local (SQLite) ou com docker-compose (PostgreSQL).

Caso de dÃºvidas, vocÃª pode me contatar!  
ğŸ¤˜ Gabriela Mota